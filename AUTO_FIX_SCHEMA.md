# üéâ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã PostgreSQL

## ‚úÖ –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û (commit 317fd18)

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –¥–µ–ø–ª–æ–µ –Ω–∞ Render **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ö–µ–º—ã `investment`
2. ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ç–∞–±–ª–∏—Ü (–±–µ–∑ `full_name`, —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏)
3. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** —Å—Ç–∞—Ä—ã—Ö —Ç–∞–±–ª–∏—Ü **–¢–û–õ–¨–ö–û –≤ —Å—Ö–µ–º–µ `investment`**
4. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚ö° **–£–¥–∞–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –¢–û–õ–¨–ö–û –≤ —Å—Ö–µ–º–µ `investment`**
- ‚ö° **–î—Ä—É–≥–∏–µ –≤–∞—à–∏ –ø—Ä–æ–µ–∫—Ç—ã –ù–ï –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è**
- ‚ö° **–î—Ä—É–≥–∏–µ —Å—Ö–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ—Ç—Ä–æ–Ω—É—Ç—ã–º–∏**

---

## üöÄ –ß–¢–û –î–ï–õ–ê–¢–¨ –°–ï–ô–ß–ê–°

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–∂–¥–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è (5-10 –º–∏–Ω—É—Ç)

Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –¥–µ–ø–ª–æ–π:

```
‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞ 317fd18
‚úÖ Running database migrations...
üîç Checking schema structure: investment
‚ö†Ô∏è Detected old schema structure (missing full_name column)
üîÑ Recreating tables with correct structure...
üóëÔ∏è Dropping all tables in schema: investment
‚ö†Ô∏è This will NOT affect other schemas in your database!
‚úÖ All tables dropped from schema: investment
üíæ Other schemas in your database are NOT affected
‚úÖ Old tables dropped, migrations will create new ones
üìã Creating tables...
‚úÖ Tables created
‚úÖ Indexes created
‚úÖ Database migrations completed successfully!
üöÄ Server is running on port 5000
```

**–í—Å—ë! –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∞–π—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é.**

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å (–µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∂–¥–∞—Ç—å)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Render Dashboard**
2. **–í–∞—à Web Service** ‚Üí **Manual Deploy** ‚Üí **Clear build cache & deploy**
3. **–°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏** - –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã—à–µ ‚òùÔ∏è

---

## üìã –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç

### 1. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º:

**–°–∫—Ä–∏–ø—Ç `schema-fix.js` –ø—Ä–æ–≤–µ—Ä–∏—Ç:**
```sql
SELECT column_name 
FROM information_schema.columns 
WHERE table_schema = 'investment' 
  AND table_name = 'users' 
  AND column_name = 'full_name';
```

**–ï—Å–ª–∏ `full_name` –ù–ï –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `products` –≤–º–µ—Å—Ç–æ `investment_products`:**

```sql
SET search_path TO investment, public;

-- –£–¥–∞–ª—è–µ–º –í–°–ï —Ç–∞–±–ª–∏—Ü—ã –¢–û–õ–¨–ö–û –≤ —Å—Ö–µ–º–µ investment
DROP TABLE IF EXISTS withdrawals CASCADE;
DROP TABLE IF EXISTS social_links CASCADE;
DROP TABLE IF EXISTS payment_settings CASCADE;
DROP TABLE IF EXISTS deposits CASCADE;
DROP TABLE IF EXISTS payment_requests CASCADE;
DROP TABLE IF EXISTS transactions CASCADE;
DROP TABLE IF EXISTS user_investments CASCADE;
DROP TABLE IF EXISTS investment_products CASCADE;
DROP TABLE IF EXISTS products CASCADE;
DROP TABLE IF EXISTS investments CASCADE;
DROP TABLE IF EXISTS users CASCADE;
```

### 2. –ó–∞—Ç–µ–º `migrations.js` —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  full_name VARCHAR(255) NOT NULL,  -- ‚úÖ –ï–°–¢–¨!
  phone VARCHAR(50),
  role VARCHAR(50) DEFAULT 'user',
  balance DECIMAL(10,2) DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE investment_products (  -- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –ò–ú–Ø!
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  min_investment DECIMAL(10,2) NOT NULL,
  expected_return DECIMAL(5,2),
  duration_months INTEGER,
  risk_level VARCHAR(50),
  category VARCHAR(100),
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –ò –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Render:
- Dashboard ‚Üí –≤–∞—à Web Service ‚Üí Logs
- –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: ‚úÖ "All tables dropped from schema: investment"
- –ó–∞—Ç–µ–º: ‚úÖ "Tables created"

### 2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://investment-05dr.onrender.com
2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É (full_name, phone –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å!)
3. **–£–°–ü–ï–•!** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

### 3. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω:
```
Email: admin@investment.com
Password: admin123
```

**–í–Ω–∏–º–∞–Ω–∏–µ:** –ê–¥–º–∏–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∑–∞–Ω–æ–≤–æ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü (—Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ).

---

## ‚ùì FAQ

### –í: –£–¥–∞–ª—è—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤?
**–û: –ù–ï–¢!** –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SET search_path TO investment` –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç **–¢–û–õ–¨–ö–û** —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –≤ —Å—Ö–µ–º–µ `investment`.

### –í: –ß—Ç–æ –µ—Å–ª–∏ —è —É–∂–µ —Å–æ–∑–¥–∞–ª –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ?
**–û:** –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É—Ç–µ—Ä—è–Ω—ã. –ù–æ:
- –ê–¥–º–∏–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∑–∞–Ω–æ–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã
- –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø **–ü–ï–†–ï–î** –¥–µ–ø–ª–æ–µ–º

### –í: –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º?
**–û:** –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Shell –Ω–∞ Render:
```bash
psql $DATABASE_URL -c "\copy investment.users TO '/tmp/users_backup.csv' CSV HEADER"
psql $DATABASE_URL -c "\copy investment.user_investments TO '/tmp/investments_backup.csv' CSV HEADER"
```

### –í: –ë—É–¥–µ—Ç –ª–∏ —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ?
**–û: –ù–ï–¢!** –û–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–¥–∏–Ω —Ä–∞–∑. –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ (—Å `full_name` –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏), –æ–Ω –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç:
```
‚úÖ Schema structure is correct
```

### –í: –ß—Ç–æ –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü –≤–æ–æ–±—â–µ –Ω–µ—Ç (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫)?
**–û:** –°–∫—Ä–∏–ø—Ç –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–µ—Ç:
```
‚úÖ No existing tables found, will create fresh schema
```
–ò –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–¥—É—Ç –≤—Å—ë —Å –Ω—É–ª—è.

---

## üìù –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. **`backend/database/schema-fix.js`** (–ù–û–í–´–ô):
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –≤ —Å—Ö–µ–º–µ `investment`
   - –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ö–µ–º–∞–º–∏

2. **`backend/database/migrations.js`** (–û–ë–ù–û–í–õ–ï–ù):
   - –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `checkAndFixSchema()` –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü
   - –¢–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ö–µ–º—É

---

## üéØ –ò–¢–û–ì–û

**–í–∞–º –±–æ–ª—å—à–µ –ù–ï –Ω—É–∂–Ω–æ:**
- ‚ùå –û—Ç–∫—Ä—ã–≤–∞—Ç—å Shell –Ω–∞ Render
- ‚ùå –í—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã `DROP TABLE` –≤—Ä—É—á–Ω—É—é
- ‚ùå –ë–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –≤ —Ç–æ–π –∂–µ –±–∞–∑–µ

**–ü—Ä–æ—Å—Ç–æ:**
‚úÖ –î–æ–∂–¥–∏—Ç–µ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è (–∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Ä—É—á–Ω—É—é)
‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - —É–≤–∏–¥–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚úÖ –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å —Å–∞–π—Ç–æ–º - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## üö® –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –í–°–Å –ï–©–Å –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É "column 'full_name' does not exist":

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - Render Dashboard ‚Üí Environment
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `DB_SCHEMA=investment`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   - –ï—Å–ª–∏ –ù–ï –≤–∏–¥–∏—Ç–µ "Dropping all tables in schema: investment" - –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ—à–ª–∞
   - –ù–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ, –ø–æ–∫–∞–∂—É –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é

3. **–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (—Ä—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ):**
   ```bash
   # –í Shell –Ω–∞ Render
   psql $DATABASE_URL
   SET search_path TO investment;
   DROP SCHEMA investment CASCADE;
   CREATE SCHEMA investment;
   \q
   # –ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ service - –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–¥—É—Ç –≤—Å—ë –∑–∞–Ω–æ–≤–æ
   ```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –æ—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø–∏—à–∏—Ç–µ! –Ø –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è.

**–í—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! üéâ**
